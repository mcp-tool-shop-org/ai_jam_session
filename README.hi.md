<p align="center">
  <a href="README.md">English</a> | <a href="README.ja.md">цЧецЬмшкЮ</a> | <a href="README.zh.md">ф╕нцЦЗ</a> | <a href="README.es.md">Espa├▒ol</a> | <a href="README.fr.md">Fran├зais</a> | <strong>рд╣рд┐рдиреНрджреА</strong> | <a href="README.it.md">Italiano</a> | <a href="README.pt-BR.md">Portugu├кs</a>
</p>

<p align="center">
  <img src="logo.svg" alt="PianoAI рд▓реЛрдЧреЛ" width="180" />
</p>

<h1 align="center">PianoAI</h1>

<p align="center">
  рдмрд┐рд▓реНрдЯ-рдЗрди рдСрдбрд┐рдпреЛ рдЗрдВрдЬрди рд╡рд╛рд▓рд╛ рдкрд┐рдпрд╛рдиреЛ рдкреНрд▓реЗрдпрд░ тАФ рд╕реНрдкреАрдХрд░ рд╕реЗ рдмрдЬрд╛рддрд╛ рд╣реИ, рдХрд┐рд╕реА рдмрд╛рд╣рд░реА рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВред MCP рд╕рд░реНрд╡рд░ + CLIред
</p>

[![Tests](https://img.shields.io/badge/tests-passing-brightgreen)](https://github.com/mcp-tool-shop-org/pianoai)
[![MCP Tools](https://img.shields.io/badge/MCP_tools-12-purple)](https://github.com/mcp-tool-shop-org/pianoai)
[![Songs](https://img.shields.io/badge/songs-10_built--in-blue)](https://github.com/mcp-tool-shop-org/ai-music-sheets)

## рдпрд╣ рдХреНрдпрд╛ рд╣реИ?

рдПрдХ TypeScript рдкрд┐рдпрд╛рдиреЛ рдкреНрд▓реЗрдпрд░ рдЬреЛ рд╕реНрдЯреИрдВрдбрд░реНрдб MIDI рдлрд╝рд╛рдЗрд▓реЗрдВ рдФрд░ рдмрд┐рд▓реНрдЯ-рдЗрди рдЧрд╛рдиреЗ рдЖрдкрдХреЗ рд╕реНрдкреАрдХрд░ рд╕реЗ рдмрдЬрд╛рддрд╛ рд╣реИред рдХрд┐рд╕реА рдмрд╛рд╣рд░реА рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ тАФ рдмрд┐рд▓реНрдЯ-рдЗрди рдСрдбрд┐рдпреЛ рдЗрдВрдЬрди рд╕рдм рдХреБрдЫ рд╕рдВрднрд╛рд▓рддрд╛ рд╣реИред LLM рдЗрдВрдЯреАрдЧреНрд░реЗрд╢рди рдХреЗ рд▓рд┐рдП MCP рд╕рд░реНрд╡рд░ рдФрд░ рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП CLI рд╢рд╛рдорд┐рд▓ рд╣реИред

рд░реАрдпрд▓-рдЯрд╛рдЗрдо рд╕рд┐рдВрдЧ-рдЕрд▓реЙрдВрдЧ рдиреИрд░реЗрд╢рди рдФрд░ рдкреНрд▓реЗрдмреИрдХ рдХреЗ рджреМрд░рд╛рди рд▓рд╛рдЗрд╡ рдЯреАрдЪрд┐рдВрдЧ рдлреАрдбрдмреИрдХ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред

## рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

- **рдмрд┐рд▓реНрдЯ-рдЗрди рдкрд┐рдпрд╛рдиреЛ рдЗрдВрдЬрди** тАФ `node-web-audio-api` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдкреАрдХрд░ рд╕реЗ рдмрдЬрд╛рддрд╛ рд╣реИ, MIDI рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ
- **рд╕реНрдЯреИрдВрдбрд░реНрдб MIDI рдлрд╝рд╛рдЗрд▓ рд╕рдкреЛрд░реНрдЯ** тАФ рдХреЛрдИ рднреА `.mid` рдлрд╝рд╛рдЗрд▓ рдмрдЬрд╛рдПрдБ: `pianoai play song.mid`
- **рд░реАрдпрд▓-рдЯрд╛рдЗрдо рдЧрд╛рдпрди** тАФ MIDI рдкреНрд▓реЗрдмреИрдХ рдХреЗ рджреМрд░рд╛рди рдиреЛрдЯ-рдирд╛рдо, рд╕реЛрд▓рдлреЗрдЬ, рдХреЙрдиреНрдЯреВрд░, рдпрд╛ рд╕рд┐рд▓реЗрдмрд▓ рдиреИрд░реЗрдЯ рдХрд░реЗрдВ
- **рд╡реЙрдЗрд╕ рдлрд╝рд┐рд▓реНрдЯрд░** тАФ рдореЗрд▓реЛрдбреА-рдУрдирд▓реА (рд╕рдмрд╕реЗ рдКрдБрдЪрд╛ рдиреЛрдЯ), рд╣рд╛рд░реНрдордиреА (рд╕рдмрд╕реЗ рдиреАрдЪрд╛), рдпрд╛ рдкреНрд░рддрд┐ рдХреЙрд░реНрдб рд╕рднреА рдиреЛрдЯреНрд╕ рдЧрд╛рдПрдБ
- **рд▓рд╛рдЗрд╡ рдЯреАрдЪрд┐рдВрдЧ рдлреАрдбрдмреИрдХ** тАФ рдкреЛрдЬрд╝реАрд╢рди-рдЕрд╡реЗрдпрд░ рдбрд╛рдпрдирд╛рдорд┐рдХреНрд╕ рдЯрд┐рдкреНрд╕, рд░реЗрдВрдЬ рдЪреЗрддрд╛рд╡рдирд┐рдпрд╛рдБ, рд╕реЗрдХреНрд╢рди рдмрд╛рдЙрдВрдбреНрд░реА, рдорд╛рдЗрд▓рд╕реНрдЯреЛрди рдШреЛрд╖рдгрд╛рдПрдБ
- **рдкреЛрдЬрд╝реАрд╢рди рдЯреНрд░реИрдХрд┐рдВрдЧ** тАФ рд░реЙ MIDI рд╕реЗ рдмреАрдЯ/рдореЗрдЬрд╝рд░/рдЯреЗрдореНрдкреЛ рдореИрдкрд┐рдВрдЧ, рд╕реАрдХ рд╕рдкреЛрд░реНрдЯ рдХреЗ рд╕рд╛рде
- **4 рдкреНрд▓реЗрдмреИрдХ рдореЛрдб** тАФ full, measure-by-measure, hands separate, loop
- **рд╕реНрдкреАрдб рдХрдВрдЯреНрд░реЛрд▓** тАФ 0.5x рдзреАрдореЗ рдЕрднреНрдпрд╛рд╕ рд╕реЗ 4x рддреЗрдЬрд╝ рддрдХ, рдЯреЗрдореНрдкреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдХреЗ рд╕рд╛рде рд╕реНрдЯреИрдХ рд╣реЛрддрд╛ рд╣реИ
- **рд░реАрдпрд▓-рдЯрд╛рдЗрдо рдХрдВрдЯреНрд░реЛрд▓** тАФ рдкреНрд▓реЗрдмреИрдХ рдХреЗ рджреМрд░рд╛рди рдЗрд╡реЗрдВрдЯ рд▓рд┐рд╕рдирд░ рдХреЗ рд╕рд╛рде рдкреЙрдЬрд╝, рд░рд┐рдЬрд╝реНрдпреВрдо, рд╕реНрдкреАрдб рдмрджрд▓реЗрдВ, рд╕реАрдХ рдХрд░реЗрдВ
- **12 MCP рдЯреВрд▓** тАФ play, pause, speed, stop, browse, sing, teach тАФ рд╕рдм MCP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ
- **12 рдЯреАрдЪрд┐рдВрдЧ рд╣реБрдХ** тАФ console, silent, recording, callback, voice, aside, sing-along, live feedback, MIDI singing, MIDI live feedback, compose
- **рд╡реИрдХрд▓реНрдкрд┐рдХ MIDI рдЖрдЙрдЯрдкреБрдЯ** тАФ `--midi` рдлрд╝реНрд▓реИрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмрд╛рд╣рд░реА рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдкрд░ рд░реВрдЯ рдХрд░реЗрдВ (loopMIDI + VMPK рдЖрд╡рд╢реНрдпрдХ)
- **рд╕реБрд░рдХреНрд╖рд┐рдд рдкрд╛рд░реНрд╕рд┐рдВрдЧ** тАФ рдЦрд░рд╛рдм рдиреЛрдЯреНрд╕ рдПрдХрддреНрд░рд┐рдд `ParseWarning` рдХреЗ рд╕рд╛рде рд╕реБрдЪрд╛рд░реВ рд░реВрдк рд╕реЗ рд╕реНрдХрд┐рдк рд╣реЛрддреЗ рд╣реИрдВ
- **рдореЙрдХ рдХрдиреЗрдХреНрдЯрд░** тАФ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдХреЗ рдмрд┐рдирд╛ рдкреВрд░реНрдг рдЯреЗрд╕реНрдЯ рдХрд╡рд░реЗрдЬ

## рдЗрдВрд╕реНрдЯреЙрд▓

```bash
npm install -g @mcptoolshop/pianoai
```

**Node.js 18+** рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдмрд╕ рдЗрддрдирд╛ рд╣реА тАФ рдХреЛрдИ MIDI рдбреНрд░рд╛рдЗрд╡рд░ рдирд╣реАрдВ, рдХреЛрдИ рд╡рд░реНрдЪреБрдЕрд▓ рдкреЛрд░реНрдЯ рдирд╣реАрдВ, рдХреЛрдИ рдмрд╛рд╣рд░реА рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдирд╣реАрдВред

## рддреНрд╡рд░рд┐рдд рдкреНрд░рд╛рд░рдВрдн

```bash
# MIDI рдлрд╝рд╛рдЗрд▓ рдмрдЬрд╛рдПрдБ
pianoai play path/to/song.mid

# рдЧрд╛рдпрди рдХреЗ рд╕рд╛рде рдмрдЬрд╛рдПрдБ (рдмрдЬрд╛рддреЗ рд╕рдордп рдиреЛрдЯ рдирд╛рдо рдиреИрд░реЗрдЯ рдХрд░реЗрдВ)
pianoai play song.mid --with-singing

# рдХреЗрд╡рд▓ рдореЗрд▓реЛрдбреА рдЧрд╛рдПрдБ (рдХреЙрд░реНрдб рдиреЛрдЯреНрд╕ рдЫреЛрдбрд╝реЗрдВ, рд╕рд┐рд░реНрдлрд╝ рд╢реАрд░реНрд╖ рд╕реНрд╡рд░)
pianoai play song.mid --with-singing --voice-filter melody-only

# рдЯреАрдЪрд┐рдВрдЧ рдлреАрдбрдмреИрдХ рдХреЗ рд╕рд╛рде рдмрдЬрд╛рдПрдБ (рдбрд╛рдпрдирд╛рдорд┐рдХреНрд╕, рдкреНрд░реЛрддреНрд╕рд╛рд╣рди)
pianoai play song.mid --with-teaching

# рдЧрд╛рдпрди рдФрд░ рдЯреАрдЪрд┐рдВрдЧ рджреЛрдиреЛрдВ рдХреЗ рд╕рд╛рде рдмрдЬрд╛рдПрдБ
pianoai play song.mid --with-singing --with-teaching --sing-mode solfege

# рдЖрдзреА рдЧрддрд┐ рдкрд░ рдЧрд╛рдпрди рдХреЗ рд╕рд╛рде рдЕрднреНрдпрд╛рд╕
pianoai play song.mid --speed 0.5 --with-singing

# 45рд╡реЗрдВ рд╕реЗрдХрдВрдб рдкрд░ рдЬрд╛рдПрдБ рдФрд░ рд╡рд╣рд╛рдБ рд╕реЗ рдмрдЬрд╛рдПрдБ
pianoai play song.mid --seek 45

# рдмрд┐рд▓реНрдЯ-рдЗрди рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЧрд╛рдирд╛ рдмрдЬрд╛рдПрдБ
pianoai play let-it-be

# рд╕рднреА рдмрд┐рд▓реНрдЯ-рдЗрди рдЧрд╛рдиреЗ рд╕реВрдЪреАрдмрджреНрдз рдХрд░реЗрдВ
pianoai list

# рдЧрд╛рдиреЗ рдХрд╛ рд╡рд┐рд╡рд░рдг + рдЯреАрдЪрд┐рдВрдЧ рдиреЛрдЯреНрд╕ рджреЗрдЦреЗрдВ
pianoai info moonlight-sonata-mvt1

# рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рдЧрд╛рдиреЗ рдХреЗ рд╕рд╛рде рд╕рд┐рдВрдЧ рдЕрд▓реЙрдВрдЧ (рд╡реЙрдЗрд╕ рдиреИрд░реЗрд╢рди)
pianoai sing let-it-be --mode solfege --with-piano
```

### рдкреНрд▓реЗ рд╡рд┐рдХрд▓реНрдк

| рдлрд╝реНрд▓реИрдЧ | рд╡рд┐рд╡рд░рдг |
|--------|--------|
| `--speed <mult>` | рд╕реНрдкреАрдб рдорд▓реНрдЯреАрдкреНрд▓рд╛рдпрд░: 0.5 = рдЖрдзрд╛, 1.0 = рд╕рд╛рдорд╛рдиреНрдп, 2.0 = рджреЛрдЧреБрдирд╛ |
| `--tempo <bpm>` | рдЧрд╛рдиреЗ рдХреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЯреЗрдореНрдкреЛ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░реЗрдВ (10-400 BPM) |
| `--mode <mode>` | рдкреНрд▓реЗрдмреИрдХ рдореЛрдб: `full`, `measure`, `hands`, `loop` |
| `--with-singing` | рд░реАрдпрд▓-рдЯрд╛рдЗрдо рд╕рд┐рдВрдЧ-рдЕрд▓реЙрдВрдЧ рдиреИрд░реЗрд╢рди рд╕рдХреНрд╖рдо рдХрд░реЗрдВ |
| `--with-teaching` | рд▓рд╛рдЗрд╡ рдЯреАрдЪрд┐рдВрдЧ рдлреАрдбрдмреИрдХ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ |
| `--sing-mode <mode>` | рд╕рд┐рдВрдЧ рдореЛрдб: `note-names`, `solfege`, `contour`, `syllables` |
| `--voice-filter <f>` | рд╡реЙрдЗрд╕ рдлрд╝рд┐рд▓реНрдЯрд░: `all`, `melody-only`, `harmony` |
| `--seek <seconds>` | рдмрдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдордп рдкрд░ рдЬрд╛рдПрдБ |
| `--midi` | рдмрд┐рд▓реНрдЯ-рдЗрди рдЗрдВрдЬрди рдХреЗ рдмрдЬрд╛рдп рдмрд╛рд╣рд░реА MIDI рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдкрд░ рд░реВрдЯ рдХрд░реЗрдВ |

## MCP рд╕рд░реНрд╡рд░

MCP рд╕рд░реНрд╡рд░ LLM рдЗрдВрдЯреАрдЧреНрд░реЗрд╢рди рдХреЗ рд▓рд┐рдП 12 рдЯреВрд▓ рдЙрдкрд▓рдмреНрдз рдХрд░рд╛рддрд╛ рд╣реИ:

| рдЯреВрд▓ | рд╡рд┐рд╡рд░рдг |
|------|--------|
| `list_songs` | рд╢реИрд▓реА, рдХрдард┐рдирд╛рдИ, рдпрд╛ рдХреНрд╡реЗрд░реА рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЧрд╛рдиреЗ рдмреНрд░рд╛рдЙрдЬрд╝/рдЦреЛрдЬреЗрдВ |
| `song_info` | рдкреВрд░реНрдг рд╕рдВрдЧреАрдд рднрд╛рд╖рд╛, рд╢рд┐рдХреНрд╖рдг рд▓рдХреНрд╖реНрдп, рдЕрднреНрдпрд╛рд╕ рд╕реБрдЭрд╛рд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ |
| `registry_stats` | рд╢реИрд▓реА рдФрд░ рдХрдард┐рдирд╛рдИ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЧрд╛рдиреЛрдВ рдХреА рдЧрд┐рдирддреА |
| `teaching_note` | рдкреНрд░рддрд┐-рдореЗрдЬрд╝рд░ рдЯреАрдЪрд┐рдВрдЧ рдиреЛрдЯ, рдлрд╝рд┐рдВрдЧрд░рд┐рдВрдЧ, рдбрд╛рдпрдирд╛рдорд┐рдХреНрд╕ |
| `suggest_song` | рдорд╛рдирджрдВрдбреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ |
| `list_measures` | рдЯреАрдЪрд┐рдВрдЧ рдиреЛрдЯреНрд╕ + рдкрд╛рд░реНрд╕ рдЪреЗрддрд╛рд╡рдирд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдореЗрдЬрд╝рд░ рдХрд╛ рдЕрд╡рд▓реЛрдХрди |
| `sing_along` | рдкреНрд░рддрд┐-рдореЗрдЬрд╝рд░ рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЯреЗрдХреНрд╕реНрдЯ (рдиреЛрдЯ рдирд╛рдо, рд╕реЛрд▓рдлреЗрдЬ, рдХреЙрдиреНрдЯреВрд░, рд╕рд┐рд▓реЗрдмрд▓) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ |
| `practice_setup` | рдХрд┐рд╕реА рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдкреАрдб, рдореЛрдб, рдФрд░ рд╡реЙрдЗрд╕ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд╕реБрдЭрд╛рдПрдБ |
| `play_song` | рд╡реИрдХрд▓реНрдкрд┐рдХ рдЧрд╛рдпрди рдФрд░ рдЯреАрдЪрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЧрд╛рдирд╛ рдпрд╛ MIDI рдлрд╝рд╛рдЗрд▓ рдмрдЬрд╛рдПрдБ |
| `pause_playback` | рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдмрдЬ рд░рд╣реЗ рдЧрд╛рдиреЗ рдХреЛ рдкреЙрдЬрд╝ рдпрд╛ рд░рд┐рдЬрд╝реНрдпреВрдо рдХрд░реЗрдВ |
| `set_speed` | рдкреНрд▓реЗрдмреИрдХ рдХреЗ рджреМрд░рд╛рди рд╕реНрдкреАрдб рдмрджрд▓реЗрдВ |
| `stop_playback` | рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдмрдЬ рд░рд╣реЗ рдЧрд╛рдиреЗ рдХреЛ рд░реЛрдХреЗрдВ |

### Claude Desktop рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди

```json
{
  "mcpServers": {
    "pianoai": {
      "command": "npx",
      "args": ["-y", "-p", "@mcptoolshop/pianoai", "pianoai-mcp"]
    }
  }
}
```

### рдЧрд╛рдпрди рдФрд░ рдЯреАрдЪрд┐рдВрдЧ рдХреЗ рд╕рд╛рде play_song

`play_song` MCP рдЯреВрд▓ `withSinging` рдФрд░ `withTeaching` рдлрд╝реНрд▓реИрдЧ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ:

```
play_song({ id: "path/to/song.mid", withSinging: true, withTeaching: true, singMode: "solfege" })
```

## рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ API

### рд░реАрдпрд▓-рдЯрд╛рдЗрдо рдХрдВрдЯреНрд░реЛрд▓ рдХреЗ рд╕рд╛рде MIDI рдлрд╝рд╛рдЗрд▓ рдмрдЬрд╛рдПрдБ

```typescript
import { createAudioEngine, parseMidiFile, PlaybackController } from "@mcptoolshop/pianoai";

const connector = createAudioEngine();
await connector.connect();

const midi = await parseMidiFile("song.mid");
const controller = new PlaybackController(connector, midi);

// рдЗрд╡реЗрдВрдЯ рд╕реБрдиреЗрдВ
controller.on("noteOn", (e) => console.log(`Note: ${e.noteName}`));
controller.on("stateChange", (e) => console.log(`State: ${e.state}`));

await controller.play({ speed: 0.75 });

controller.pause();       // рдкреЙрдЬрд╝
controller.setSpeed(1.5); // рд╕реНрдкреАрдб рдмрджрд▓реЗрдВ
await controller.resume();// рдирдИ рд╕реНрдкреАрдб рдкрд░ рд░рд┐рдЬрд╝реНрдпреВрдо

await connector.disconnect();
```

### рдЧрд╛рдпрди рдФрд░ рд▓рд╛рдЗрд╡ рдЯреАрдЪрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдмрдЬрд╛рдПрдБ

```typescript
import {
  createAudioEngine,
  parseMidiFile,
  PlaybackController,
  createSingOnMidiHook,
  createLiveMidiFeedbackHook,
  composeTeachingHooks,
} from "@mcptoolshop/pianoai";

const connector = createAudioEngine();
await connector.connect();
const midi = await parseMidiFile("song.mid");

const singHook = createSingOnMidiHook(
  async (d) => console.log(`тЩк ${d.text}`),
  midi,
  { mode: "solfege", voiceFilter: "melody-only" }
);

const feedbackHook = createLiveMidiFeedbackHook(
  async (d) => console.log(`ЁЯОУ ${d.text}`),
  async (d) => console.log(`ЁЯТб ${d.text}`),
  midi,
  { voiceInterval: 8 }
);

const composed = composeTeachingHooks(singHook, feedbackHook);
const controller = new PlaybackController(connector, midi);
await controller.play({ teachingHook: composed });

// feedbackHook.tracker рдореЗрдВ рдкреЛрдЬрд╝реАрд╢рди рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╣реИ
console.log(`Total measures: ${feedbackHook.tracker.totalMeasures}`);
```

### рдмрд┐рд▓реНрдЯ-рдЗрди рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЧрд╛рдирд╛ рдмрдЬрд╛рдПрдБ

```typescript
import { getSong } from "@mcptoolshop/ai-music-sheets";
import { createSession, createAudioEngine } from "@mcptoolshop/pianoai";

const connector = createAudioEngine();
await connector.connect();

const song = getSong("autumn-leaves")!;
const session = createSession(song, connector, {
  mode: "full",
  speed: 0.75,
});

await session.play();
await connector.disconnect();
```

## рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░

```
Standard MIDI files (.mid)   Built-in songs (ai-music-sheets)
        тФВ                              тФВ
        тЦ╝                              тЦ╝
   MIDI Parser тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФА Note Parser
        тФВ                              тФВ
        тЦ╝                              тЦ╝
  MidiPlaybackEngine            SessionController
        тФВ                              тФВ
        тФФтФАтФАтФАтФАтФАтФАтФАтФА PlaybackController тФАтФАтФШ
                  (real-time events, hooks)
                         тФВ
           тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФ╝тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
           тЦ╝             тЦ╝             тЦ╝
      AudioEngine   Teaching Hooks  Progress
      (speakers)    (sing, feedback) (callbacks)
           тФВ
           тЦ╝
     node-web-audio-api (Rust DSP)

Position tracking:
  MIDI Parser тЖТ PositionTracker тЖТ beat/measure/tempo mapping
                                тЖТ seek-to-time / seek-to-measure
                                тЖТ measure summaries for live feedback

Teaching hook routing:
  PlaybackController тЖТ TeachingHook тЖТ VoiceDirective тЖТ mcp-voice-soundboard
                                    тЖТ AsideDirective тЖТ mcp-aside inbox
                                    тЖТ Console log    тЖТ CLI terminal
                                    тЖТ Recording      тЖТ test assertions
```

## рдЯреЗрд╕реНрдЯрд┐рдВрдЧ

```bash
pnpm test       # 243 Vitest рдЯреЗрд╕реНрдЯ
pnpm typecheck  # tsc --noEmit
pnpm smoke      # рдЗрдВрдЯреАрдЧреНрд░реЗрд╢рди рд╕реНрдореЛрдХ рдЯреЗрд╕реНрдЯ
```

## рд╕рдВрдмрдВрдзрд┐рдд

- **[ai-music-sheets](https://github.com/mcp-tool-shop-org/ai-music-sheets)** тАФ рдмрд┐рд▓реНрдЯ-рдЗрди рдЧрд╛рдиреЛрдВ рдХреА рд▓рд╛рдЗрдмреНрд░реЗрд░реА

## рд▓рд╛рдЗрд╕реЗрдВрд╕

MIT
